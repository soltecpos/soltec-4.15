//SmartPOS - Punto de Venta Touch - Copyright Alejandro Camargo 2018 - (c) Unisen, OpenBravo, Chromun

// **************************************************************************
// Ticket.Close
// This script displays the amount of Cash Change (CashTendered - TicketValue) to be given to Customer

        import java.awt.Font;
        import javax.swing.plaf.FontUIResource;
        import com.openbravo.pos.payment.PaymentInfo;
        import javax.swing.JOptionPane;
        import javax.swing.JDialog;
        import uk.co.pos_apps.PosApps;
        import java.awt.Window;



        Window rootWindow ;

        Window[] allWindows = Window.getWindows();

        for (int i=0 ; i < allWindows.length; i++){
        if (allWindows[i].getName().equals("frame0")){
        rootWindow = (Window)allWindows[i];
        }
        }       



boolean isCash = false;
String change = "";
PaymentInfo p = ticket.payments.getFirst();

if ("cash".equals(p.getName())) {
    isCash = true;
    change = p.printChange();
}

// Get details of the original font before we change it otherwise all dialogboxes will use new settings
JOptionPane pane = new JOptionPane();
Font originalFont=pane.getFont();

UIManager.put("OptionPane.buttonFont", new FontUIResource(new Font("ARIAL",Font.PLAIN,20)));
message = "Cambio: " + change;
 JLabel FontText = new JLabel(message);
 FontText.setFont (new Font ( "Arial", Font.BOLD, 36) );

if(isCash) {
     JOptionPane pane = new JOptionPane();
     pane.setMessage(FontText);
     pane.setPreferredSize( new Dimension(450,150));
     JDialog dialog = pane.createDialog("Pago en efectivo");
    new Thread(new Runnable() { void run() {
        dialog.show();
    } }).start();
}

// Return to default settings
UIManager.put("OptionPane.buttonFont", new FontUIResource(new Font(originalFont.getName(),originalFont.getStyle(),originalFont.getSize())));